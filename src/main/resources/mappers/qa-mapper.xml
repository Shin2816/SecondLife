<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- 해당 파일에 모든 쿼리문을 작성 -->
<mapper namespace="qaMapper">
    <!--Q&A 게시판 목록-->
    <resultMap id="qaList" type="com.green.SecondLife.community.vo.BoardQaListVO">
        <id column="QA_BOARD_NUM" property="qaBoardNum"/>
        <result column="QA_BOARD_TITLE" property="qaBoardTitle"/>
        <result column="QA_BOARD_CONTENT" property="qaBoardContent"/>
        <result column="QA_BOARD_WRITER" property="qaBoardWriter"/>
        <result column="QA_CREATE_DATE" property="qaCreateDate"/>
        <result column="QA_BOARD_READ_CNT" property="qaBoardReadCnt"/>
        <result column="QA_BOARD_ISCLOSE" property="qaBoardIsClose"/>
        <result column="QA_BOARD_PASSWORD" property="qaBoardPassword"/>
    </resultMap>
    <!--Q&A 게시판 목록 조회-->
    <select id="selectQaBoardList" resultMap="qaList">
        SELECT QA_BOARD_NUM
        , QA_BOARD_TITLE
        , QA_BOARD_WRITER
        , TO_CHAR(QA_CREATE_DATE, 'YYYY-MM-DD') QA_CREATE_DATE
        , QA_BOARD_READ_CNT
        FROM BOARD_QA_LIST
        <if test='searchValue != null and !searchValue.equals("")'>
            WHERE UPPER(${searchType}) LIKE '%'||UPPER(#{searchValue})||'%'
        </if>
        ORDER BY QA_BOARD_NUM DESC
        OFFSET (#{nowPage} - 1) * #{displayDataCnt} ROWS FETCH FIRST #{displayDataCnt} ROWS ONLY
    </select>
    <!--게시글 갯수 조회-->
    <select id="selectBoardCnt" resultType="int">
        SELECT COUNT(QA_BOARD_NUM)
        FROM BOARD_QA_LIST
    </select>
    <!--자유게시판 글 등록-->
    <insert id="insertQaBoard">
        INSERT INTO BOARD_QA_LIST(
        QA_BOARD_NUM
        , QA_BOARD_TITLE
        , QA_BOARD_CONTENT
        , QA_BOARD_WRITER
        ) VALUES(
        (SELECT NVL(MAX(QA_BOARD_NUM), 0) + 1 FROM BOARD_QA_LIST)
        , #{qaBoardTitle}
        , #{qaBoardContent}
        , #{qaBoardWriter}
        )
    </insert>
    <!--메인페이지 자유게시판 목록 조회-->
    <select id="selectMainQaBoardList" resultMap="qaList">
        SELECT ROW_NUM
            , QA_BOARD_NUM
            , QA_BOARD_TITLE
            , QA_BOARD_WRITER
            , TO_CHAR(QA_CREATE_DATE, 'YYYY-MM-DD') QA_CREATE_DATE
            , QA_BOARD_READ_CNT
        FROM (
        SELECT ROWNUM AS ROW_NUM
            , QA_BOARD_NUM
            , QA_BOARD_TITLE
            , QA_BOARD_WRITER
            , QA_CREATE_DATE
            , QA_BOARD_READ_CNT
        FROM (
        SELECT *
        FROM BOARD_QA_LIST
        ORDER BY QA_CREATE_DATE DESC
        )
        )
        WHERE ROWNUM &lt;= 5
    </select>
</mapper>































